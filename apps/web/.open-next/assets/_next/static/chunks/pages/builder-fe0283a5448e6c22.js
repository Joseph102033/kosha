(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[261],{2226:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return n}});let a=s(4232),r=a.useLayoutEffect,l=a.useEffect;function n(e){let{headManager:t,reduceComponentsToState:s}=e;function n(){if(t&&t.mountedInstances){let r=a.Children.toArray(Array.from(t.mountedInstances).filter(Boolean));t.updateHead(s(r,e))}}return r(()=>{var s;return null==t||null==(s=t.mountedInstances)||s.add(e.children),()=>{var s;null==t||null==(s=t.mountedInstances)||s.delete(e.children)}}),r(()=>(t&&(t._pendingUpdate=n),()=>{t&&(t._pendingUpdate=n)})),l(()=>(t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null),()=>{t&&t._pendingUpdate&&(t._pendingUpdate(),t._pendingUpdate=null)})),null}},3169:(e,t)=>{"use strict";function s(e){let{ampFirst:t=!1,hybrid:s=!1,hasQuery:a=!1}=void 0===e?{}:e;return t||s&&a}Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"isInAmpMode",{enumerable:!0,get:function(){return s}})},3983:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>u});var a=s(7876),r=s(4232),l=s(7328),n=s.n(l);let i="ops_access_key";function d(){return localStorage.getItem(i)}async function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=function(){let e=d();return e?"Bearer ".concat(e):null}(),a=new Headers(t.headers);return s&&a.set("Authorization",s),fetch(e,{...t,headers:a})}let o="http://localhost:8787";function u(){let[e,t]=(0,r.useState)({title:"",incidentDate:"",location:"",agentObject:"",hazardObject:"",incidentType:"",incidentCause:""}),[s,l]=(0,r.useState)(null),[u,m]=(0,r.useState)(!1),[x,h]=(0,r.useState)(null),[p,b]=(0,r.useState)("summary"),[g,f]=(0,r.useState)(!1),[y,j]=(0,r.useState)(null),[v,N]=(0,r.useState)(null),[w,O]=(0,r.useState)(!1),[k,C]=(0,r.useState)(""),[S,_]=(0,r.useState)(!1);(0,r.useEffect)(()=>{_(!!d())},[]),(0,r.useEffect)(()=>{let t=async()=>{m(!0),h(null);try{let t=await c("".concat(o,"/api/ops/generate"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(401===t.status){h("Unauthorized: Please enter your access key"),O(!0);return}let s=await t.json();s.success&&s.data?l(s.data):h(s.error||"Failed to generate preview")}catch(e){h("Network error: Unable to connect to API")}finally{m(!1)}},s=setTimeout(()=>{e.incidentDate&&e.location&&e.incidentType&&e.incidentCause&&t()},1e3);return()=>clearTimeout(s)},[e]);let P=(e,s)=>{t(t=>({...t,[e]:s}))},D=async()=>{if(!s)return void N("Please wait for preview to generate");if(!e.title.trim())return void N("Please enter a title for this OPS document");f(!0),N(null);try{let t=await c("".concat(o,"/api/ops/save"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:e.title,incidentDate:e.incidentDate,location:e.location,agentObject:e.agentObject,hazardObject:e.hazardObject,incidentType:e.incidentType,incidentCause:e.incidentCause,opsDocument:s})});if(401===t.status){N("Unauthorized: Please enter your access key"),O(!0);return}let a=await t.json();a.success&&a.data?j(a.data.publicUrl):N(a.error||"Failed to publish OPS document")}catch(e){N("Network error: Unable to publish OPS document")}finally{f(!1)}},T=()=>{if(k.trim()){var e;e=k.trim(),localStorage.setItem(i,e),_(!0),O(!1),C("")}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(n(),{children:(0,a.jsx)("title",{children:"OPS 작성 도구 | 안전 OPS 뉴스레터"})}),(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"bg-white border-b border-gray-200",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"OPS 작성 도구"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"재해 정보를 입력하여 OPS 자료를 자동 생성합니다"})]}),(0,a.jsx)("button",{onClick:()=>O(!0),className:"px-4 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:S?"\uD83D\uDD11 키 변경":"\uD83D\uDD11 액세스 키 입력"})]})})}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"재해 정보 입력"}),(0,a.jsxs)("form",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:["OPS 제목 ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"text",id:"title",value:e.title,onChange:e=>P("title",e.target.value),placeholder:"예: 비계 추락사고 - 2025년 1월",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"incidentDate",className:"block text-sm font-medium text-gray-700 mb-1",children:["재해 발생 일시 ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"datetime-local",id:"incidentDate",value:e.incidentDate,onChange:e=>P("incidentDate",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 mb-1",children:["재해 발생 장소 ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"text",id:"location",value:e.location,onChange:e=>P("location",e.target.value),placeholder:"예: 서울 건설현장 A동",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"agentObject",className:"block text-sm font-medium text-gray-700 mb-1",children:["기인물 ",(0,a.jsx)("span",{className:"text-gray-400",children:"(선택)"})]}),(0,a.jsx)("input",{type:"text",id:"agentObject",value:e.agentObject,onChange:e=>P("agentObject",e.target.value),placeholder:"예: 작업자, 기계 조작자",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"hazardObject",className:"block text-sm font-medium text-gray-700 mb-1",children:["가해물 ",(0,a.jsx)("span",{className:"text-gray-400",children:"(선택)"})]}),(0,a.jsx)("input",{type:"text",id:"hazardObject",value:e.hazardObject,onChange:e=>P("hazardObject",e.target.value),placeholder:"예: 비계, 화학물질 용기",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"incidentType",className:"block text-sm font-medium text-gray-700 mb-1",children:["재해 발생 형태 ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("select",{id:"incidentType",value:e.incidentType,onChange:e=>P("incidentType",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[(0,a.jsx)("option",{value:"",children:"재해 유형 선택"}),(0,a.jsx)("option",{value:"Fall",children:"추락"}),(0,a.jsx)("option",{value:"Chemical Spill",children:"화학물질 누출"}),(0,a.jsx)("option",{value:"Fire",children:"화재"}),(0,a.jsx)("option",{value:"Explosion",children:"폭발"}),(0,a.jsx)("option",{value:"Equipment Failure",children:"장비 고장"}),(0,a.jsx)("option",{value:"Other",children:"기타"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"incidentCause",className:"block text-sm font-medium text-gray-700 mb-1",children:["재해 발생 원인 ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("textarea",{id:"incidentCause",value:e.incidentCause,onChange:e=>P("incidentCause",e.target.value),placeholder:"재해의 주요 원인을 상세히 기술해 주세요...",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm",children:[u&&(0,a.jsx)("span",{className:"text-blue-600",children:"⏳ 미리보기 생성 중..."}),x&&(0,a.jsxs)("span",{className:"text-red-600",children:["⚠️ ",x]}),s&&!u&&!x&&(0,a.jsx)("span",{className:"text-green-600",children:"✓ 미리보기 생성 완료"})]}),(0,a.jsxs)("div",{className:"pt-4 border-t border-gray-200",children:[(0,a.jsx)("button",{type:"button",onClick:D,disabled:g||!s||!e.title.trim(),className:"w-full px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed font-medium transition-colors",children:g?"\uD83D\uDCE4 발행 중...":"\uD83D\uDCE4 OPS 문서 발행"}),v&&(0,a.jsxs)("p",{className:"text-red-600 text-sm mt-2",children:["⚠️ ",v]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"실시간 미리보기"}),!s&&(0,a.jsx)("div",{className:"text-center py-12 text-gray-400",children:(0,a.jsx)("p",{children:"폼을 작성하면 미리보기가 표시됩니다"})}),s&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"border-b border-gray-200 mb-4",children:(0,a.jsx)("nav",{className:"flex -mb-px space-x-4",children:["summary","causes","checklist","laws"].map(e=>(0,a.jsxs)("button",{onClick:()=>b(e),className:"py-2 px-3 text-sm font-medium border-b-2 transition-colors ".concat(p===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:["summary"===e&&"요약","causes"===e&&"원인 분석","checklist"===e&&"재발방지 체크리스트","laws"===e&&"관련 법령"]},e))})}),(0,a.jsxs)("div",{className:"prose prose-sm max-w-none",children:["summary"===p&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-base font-semibold mb-2",children:"사고 개요"}),(0,a.jsx)("p",{className:"whitespace-pre-line text-gray-700",children:s.summary})]}),"causes"===p&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"직접 원인"}),(0,a.jsx)("ul",{className:"list-disc list-inside space-y-1",children:s.causes.direct.map((e,t)=>(0,a.jsx)("li",{className:"text-gray-700",children:e},t))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"간접 원인"}),(0,a.jsx)("ul",{className:"list-disc list-inside space-y-1",children:s.causes.indirect.map((e,t)=>(0,a.jsx)("li",{className:"text-gray-700",children:e},t))})]})]}),"checklist"===p&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-base font-semibold mb-2",children:"재발방지 체크리스트"}),(0,a.jsx)("ul",{className:"space-y-2",children:s.checklist.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("input",{type:"checkbox",className:"mt-1",disabled:!0}),(0,a.jsx)("span",{className:"text-gray-700",children:e})]},t))})]}),"laws"===p&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-base font-semibold mb-2",children:"관련 법령 및 규정"}),(0,a.jsx)("ul",{className:"space-y-2",children:s.laws.map((e,t)=>(0,a.jsx)("li",{className:"border-l-2 border-blue-500 pl-3",children:(0,a.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline font-medium",children:e.title})},t))})]})]})]})]})]})}),w&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-8 max-w-md w-full mx-4",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"\uD83D\uDD11 액세스 키 필요"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"OPS 문서를 생성하고 발행하려면 관리자 액세스 키가 필요합니다."}),(0,a.jsx)("input",{type:"password",value:k,onChange:e=>C(e.target.value),onKeyDown:e=>"Enter"===e.key&&T(),placeholder:"액세스 키를 입력하세요",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 mb-4",autoFocus:!0}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:T,disabled:!k.trim(),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors font-medium",children:"저장"}),(0,a.jsx)("button",{onClick:()=>{O(!1),C("")},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"취소"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-4",children:"\uD83D\uDCA1 액세스 키는 브라우저에 로컬 저장되며, 인증 목적으로만 서버에 전송됩니다."})]})}),y&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-8 max-w-md w-full mx-4",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"✅ OPS 문서 발행 완료!"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"OPS 문서가 성공적으로 발행되었습니다. 아래 공개 URL로 접근할 수 있습니다."}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"공개 URL:"}),(0,a.jsxs)("p",{className:"text-blue-600 break-all",children:[window.location.origin,y]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:()=>{if(y){let e="".concat(window.location.origin).concat(y);navigator.clipboard.writeText(e)}},className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"\uD83D\uDCCB 링크 복사"}),(0,a.jsx)("a",{href:y,target:"_blank",rel:"noopener noreferrer",className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium text-center",children:"\uD83D\uDC41️ 페이지 보기"})]}),(0,a.jsx)("button",{onClick:()=>j(null),className:"w-full mt-3 px-4 py-2 text-gray-600 hover:text-gray-800 text-sm",children:"닫기"})]})})]})]})}},4461:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"AmpStateContext",{enumerable:!0,get:function(){return a}});let a=s(4252)._(s(4232)).default.createContext({})},6028:(e,t,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/builder",function(){return s(3983)}])},7328:(e,t,s)=>{e.exports=s(9269)},9269:(e,t,s)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var s in t)Object.defineProperty(e,s,{enumerable:!0,get:t[s]})}(t,{default:function(){return p},defaultHead:function(){return u}});let a=s(4252),r=s(8365),l=s(7876),n=r._(s(4232)),i=a._(s(2226)),d=s(4461),c=s(7965),o=s(3169);function u(e){void 0===e&&(e=!1);let t=[(0,l.jsx)("meta",{charSet:"utf-8"},"charset")];return e||t.push((0,l.jsx)("meta",{name:"viewport",content:"width=device-width"},"viewport")),t}function m(e,t){return"string"==typeof t||"number"==typeof t?e:t.type===n.default.Fragment?e.concat(n.default.Children.toArray(t.props.children).reduce((e,t)=>"string"==typeof t||"number"==typeof t?e:e.concat(t),[])):e.concat(t)}s(6201);let x=["name","httpEquiv","charSet","itemProp"];function h(e,t){let{inAmpMode:s}=t;return e.reduce(m,[]).reverse().concat(u(s).reverse()).filter(function(){let e=new Set,t=new Set,s=new Set,a={};return r=>{let l=!0,n=!1;if(r.key&&"number"!=typeof r.key&&r.key.indexOf("$")>0){n=!0;let t=r.key.slice(r.key.indexOf("$")+1);e.has(t)?l=!1:e.add(t)}switch(r.type){case"title":case"base":t.has(r.type)?l=!1:t.add(r.type);break;case"meta":for(let e=0,t=x.length;e<t;e++){let t=x[e];if(r.props.hasOwnProperty(t))if("charSet"===t)s.has(t)?l=!1:s.add(t);else{let e=r.props[t],s=a[t]||new Set;("name"!==t||!n)&&s.has(e)?l=!1:(s.add(e),a[t]=s)}}}return l}}()).reverse().map((e,t)=>{let s=e.key||t;return n.default.cloneElement(e,{key:s})})}let p=function(e){let{children:t}=e,s=(0,n.useContext)(d.AmpStateContext),a=(0,n.useContext)(c.HeadManagerContext);return(0,l.jsx)(i.default,{reduceComponentsToState:h,headManager:a,inAmpMode:(0,o.isInAmpMode)(s),children:t})};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)}},e=>{e.O(0,[636,593,792],()=>e(e.s=6028)),_N_E=e.O()}]);