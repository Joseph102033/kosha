(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[261],{1859:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>y});var a=t(7876),l=t(4232),r=t(7328),i=t.n(r);let n="ops_access_key";function c(){return localStorage.getItem(n)}async function d(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=function(){let e=c();return e?"Bearer ".concat(e):null}(),a=new Headers(s.headers);return t&&a.set("Authorization",t),fetch(e,{...s,headers:a})}var o=t(1820);let m=o.Ikc({title:o.YjP().min(1,"Law title is required"),url:o.YjP().url("Invalid URL format")}),x=o.Ikc({direct:o.YOg(o.YjP().min(1)).min(1,"At least one direct cause required").max(5),indirect:o.YOg(o.YjP().min(1)).min(1,"At least one indirect cause required").max(6)}),u=o.Ikc({type:o.k5n(["placeholder","generated"]),url:o.YjP().url().optional()}),h=o.Ikc({summary:o.YjP().min(10,"Summary too short").max(1e3,"Summary too long"),causes:x,checklist:o.YOg(o.YjP().min(1)).min(4,"At least 4 checklist items required").max(12),laws:o.YOg(m).min(0).max(10),imageMeta:u.optional()});function b(e){let{className:s=""}=e;return(0,a.jsx)("div",{className:"animate-pulse bg-gray-200 rounded ".concat(s)})}function g(e){let{activeTab:s}=e;return"summary"===s?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)(b,{className:"h-6 w-32"}),(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[(0,a.jsx)(b,{className:"h-32 w-full mb-2"}),(0,a.jsx)(b,{className:"h-4 w-48"})]}),(0,a.jsx)(b,{className:"h-4 w-full"}),(0,a.jsx)(b,{className:"h-4 w-full"}),(0,a.jsx)(b,{className:"h-4 w-3/4"}),(0,a.jsx)(b,{className:"h-4 w-5/6"})]}):"causes"===s?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(b,{className:"h-5 w-24 mb-2"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(b,{className:"h-4 w-full"}),(0,a.jsx)(b,{className:"h-4 w-5/6"}),(0,a.jsx)(b,{className:"h-4 w-4/5"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)(b,{className:"h-5 w-24 mb-2"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(b,{className:"h-4 w-full"}),(0,a.jsx)(b,{className:"h-4 w-11/12"}),(0,a.jsx)(b,{className:"h-4 w-5/6"}),(0,a.jsx)(b,{className:"h-4 w-4/5"})]})]})]}):"checklist"===s?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(b,{className:"h-5 w-48 mb-3"}),[...Array(7)].map((e,s)=>(0,a.jsxs)("div",{className:"flex items-start gap-2",children:[(0,a.jsx)(b,{className:"h-4 w-4 mt-1 flex-shrink-0"}),(0,a.jsx)("div",{className:"h-4 flex-1 animate-pulse bg-gray-200 rounded"})]},s))]}):"laws"===s?(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(b,{className:"h-5 w-40 mb-3"}),[void 0,void 0,void 0].map((e,s)=>(0,a.jsx)("div",{className:"border-l-2 border-gray-300 pl-3",children:(0,a.jsx)(b,{className:"h-4 w-5/6"})},s))]}):null}function p(e){let{state:s,data:t,error:r,activeTab:i,onTabChange:n}=e,[c,d]=(0,l.useState)(!1);return(0,l.useEffect)(()=>{if("generating"===s){let e=setTimeout(()=>d(!0),1e3);return()=>clearTimeout(e)}d(!1)},[s]),(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"실시간 미리보기"}),"generating"===s&&c&&(0,a.jsx)("span",{className:"text-xs text-blue-600 animate-pulse",children:"⏱️ AI 분석 중..."}),"dummy"===s&&(0,a.jsx)("span",{className:"text-xs text-amber-600",children:"\uD83D\uDCDD 초안 (더미 데이터)"}),"ready"===s&&(0,a.jsx)("span",{className:"text-xs text-green-600",children:"✓ 생성 완료"})]}),"idle"===s&&(0,a.jsxs)("div",{className:"text-center py-12 text-gray-400",children:[(0,a.jsx)("div",{className:"text-5xl mb-4",children:"\uD83D\uDCCB"}),(0,a.jsx)("p",{className:"text-base font-medium mb-2",children:"폼을 작성하면 미리보기가 표시됩니다"}),(0,a.jsx)("p",{className:"text-sm",children:"재해 발생 일시, 장소, 유형, 원인을 입력하세요"})]}),"skeleton"===s&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"border-b border-gray-200 mb-4",children:(0,a.jsx)("nav",{className:"flex -mb-px space-x-4",children:["summary","causes","checklist","laws"].map(e=>(0,a.jsxs)("div",{className:"py-2 px-3 text-sm font-medium border-b-2 border-transparent text-gray-400",children:["summary"===e&&"요약","causes"===e&&"원인 분석","checklist"===e&&"재발방지 체크리스트","laws"===e&&"관련 법령"]},e))})}),(0,a.jsx)(g,{activeTab:i})]}),("dummy"===s||"generating"===s||"ready"===s)&&t&&(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"border-b border-gray-200 mb-4",children:(0,a.jsx)("nav",{className:"flex -mb-px space-x-4",children:["summary","causes","checklist","laws"].map(e=>(0,a.jsxs)("button",{onClick:()=>n(e),className:"py-2 px-3 text-sm font-medium border-b-2 transition-colors ".concat(i===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:["summary"===e&&"요약","causes"===e&&"원인 분석","checklist"===e&&"재발방지 체크리스트","laws"===e&&"관련 법령"]},e))})}),(0,a.jsxs)("div",{className:"prose prose-sm max-w-none",children:["summary"===i&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-base font-semibold mb-2",children:"사고 개요"}),t.imageMeta&&"generated"===t.imageMeta.type&&t.imageMeta.url&&(0,a.jsxs)("div",{className:"mb-4 rounded-lg overflow-hidden border border-gray-200",children:[(0,a.jsx)("img",{src:t.imageMeta.url,alt:"재해 상황 삽화",className:"w-full h-auto"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 p-2 bg-gray-50",children:"\uD83E\uDD16 AI 생성 안전 교육 삽화"})]}),t.imageMeta&&"placeholder"===t.imageMeta.type&&(0,a.jsxs)("div",{className:"mb-4 rounded-lg overflow-hidden border border-gray-200 bg-gray-100 p-8 text-center",children:[(0,a.jsx)("div",{className:"text-6xl mb-2",children:"\uD83C\uDFD7️"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"generating"===s?"삽화 생성 중... (AI 이미지 생성에는 시간이 걸릴 수 있습니다)":"삽화는 실제 데이터 생성 시 표시됩니다"})]}),(0,a.jsx)("p",{className:"whitespace-pre-line text-gray-700",children:t.summary})]}),"causes"===i&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"직접 원인"}),(0,a.jsx)("ul",{className:"list-disc list-inside space-y-1",children:t.causes.direct.map((e,s)=>(0,a.jsx)("li",{className:"text-gray-700",children:e},s))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-gray-900 mb-2",children:"간접 원인"}),(0,a.jsx)("ul",{className:"list-disc list-inside space-y-1",children:t.causes.indirect.map((e,s)=>(0,a.jsx)("li",{className:"text-gray-700",children:e},s))})]})]}),"checklist"===i&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-base font-semibold mb-2",children:"재발방지 체크리스트"}),(0,a.jsx)("ul",{className:"space-y-2",children:t.checklist.map((e,s)=>(0,a.jsxs)("li",{className:"flex items-start gap-2",children:[(0,a.jsx)("input",{type:"checkbox",className:"mt-1",disabled:!0}),(0,a.jsx)("span",{className:"text-gray-700",children:e})]},s))})]}),"laws"===i&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-base font-semibold mb-2",children:"관련 법령 및 규정"}),0===t.laws.length?(0,a.jsx)("p",{className:"text-gray-500 text-sm italic",children:"관련 법령을 찾는 중입니다..."}):(0,a.jsx)("ul",{className:"space-y-2",children:t.laws.map((e,s)=>(0,a.jsx)("li",{className:"border-l-2 border-blue-500 pl-3",children:(0,a.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline font-medium",children:e.title})},s))})]})]})]}),"error"===s&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"text-5xl mb-4",children:"⚠️"}),(0,a.jsx)("p",{className:"text-red-600 font-medium mb-2",children:"미리보기 생성 실패"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:r||"알 수 없는 오류가 발생했습니다"}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-4",children:"폼 내용을 확인하고 다시 시도해주세요"})]})]})}o.Ikc({title:o.YjP().min(1,"Title is required").max(200),incidentDate:o.YjP().min(1,"Incident date is required"),location:o.YjP().min(1,"Location is required").max(200),agentObject:o.YjP().max(100).optional(),hazardObject:o.YjP().max(100).optional(),incidentType:o.YjP().min(1,"Incident type is required"),incidentCause:o.YjP().min(10,"Incident cause must be at least 10 characters").max(2e3)});let j="http://localhost:8787";function y(){var e;let[s,t]=(0,l.useState)({title:"",incidentDate:"",location:"",agentObject:"",hazardObject:"",incidentType:"",incidentCause:""}),[r,m]=(0,l.useState)("idle"),[x,u]=(0,l.useState)(null),[b,g]=(0,l.useState)(null),[y,f]=(0,l.useState)("summary"),N=(0,l.useRef)(null),w=(0,l.useRef)(null),[v,S]=(0,l.useState)(!1),[k,D]=(0,l.useState)(null),[C,P]=(0,l.useState)(null),[O,T]=(0,l.useState)(null),[I,q]=(0,l.useState)(!1),[z,Y]=(0,l.useState)(""),[E,_]=(0,l.useState)(!1),[F,L]=(0,l.useState)(null),[A,M]=(0,l.useState)(null),[U,R]=(0,l.useState)([]),[W,B]=(0,l.useState)(new Set),[J,X]=(0,l.useState)(!1),[G,K]=(0,l.useState)(!1),[H,$]=(0,l.useState)(""),[Q,V]=(0,l.useState)(!1);(0,l.useEffect)(()=>{V(!!c())},[]),(0,l.useEffect)(()=>{if(N.current&&clearTimeout(N.current),w.current&&clearTimeout(w.current),!(s.incidentDate&&s.location&&s.incidentType&&s.incidentCause&&s.incidentCause.length>=10)){m("idle"),u(null),g(null);return}return m("skeleton"),g(null),w.current=setTimeout(()=>{u(function(e){var s;let t=e.incidentType||"추락",a=e.location||"작업 현장",l=e.incidentDate?new Date(e.incidentDate).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric"}):"날짜 미지정";return{summary:"".concat(l,"에 ").concat(t," 재해가 발생했습니다.\n장소: ").concat(a,"\n주요 원인: ").concat((null==(s=e.incidentCause)?void 0:s.slice(0,50))||"원인 분석 중...","\n이 재해는 즉각적인 조사와 예방 조치가 필요합니다.\n모든 관련 이해관계자는 이 OPS 자료를 검토해야 합니다."),causes:{direct:function(e){let s=e.toLowerCase();return s.includes("추락")||s.includes("fall")?["작업발판 또는 안전난간 미설치","안전벨트 및 개인보호구 미착용","작업 중 부주의 또는 균형 상실"]:s.includes("화학")||s.includes("chemical")?["화학물질 용기 파손 또는 누출","개인보호구(보호복, 마스크) 미착용","물질안전보건자료(MSDS) 미확인"]:s.includes("화재")||s.includes("fire")?["인화성 물질 부적절한 보관","화기 작업 시 안전 조치 미흡","전기 설비 과부하 또는 노후화"]:["안전 작업 절차 미준수","작업 전 위험성 평가 미실시","부적절한 작업 환경 관리"]}(t),indirect:["불충분한 안전 교육 또는 인식 부족","부적절한 위험성 평가 절차","정기적인 안전 장비 점검 미실시","고위험 작업에 대한 관리감독 부족"]},checklist:function(e){let s=e.toLowerCase();return["작업 시작 전 종합적인 위험성 평가 실시","모든 근로자가 필수 안전 교육을 이수했는지 확인","비상 상황을 위한 명확한 의사소통 체계 구축",...s.includes("추락")||s.includes("fall")?["모든 추락 방지 시스템 및 고정점 점검","개인 추락방지시스템의 적절한 사용 확인","안전난간 및 작업발판이 안전하게 설치되었는지 확인","높은 곳 작업 구역의 적절한 조명 확보"]:s.includes("화학")||s.includes("chemical")?["모든 근로자와 물질안전보건자료(MSDS) 검토","적절한 개인보호구 착용 확인","화학물질 저장 용기의 라벨 부착 확인","환기 시스템 작동 상태 확인"]:["모든 안전 장비가 사용 가능하고 양호한 상태인지 확인","작업 구역의 잠재적 위험 요소 점검","비상 대피 경로 설정","고위험 작업을 위한 전담 안전 관찰자 지정"]]}(t),laws:function(e){let s=e.toLowerCase();return s.includes("추락")||s.includes("fall")?[{title:"산업안전보건법 제38조 (추락 등의 위험 방지)",url:"https://www.law.go.kr/LSW/lsInfoP.do?lsiSeq=234639#0000"},{title:"산업안전보건기준에 관한 규칙 제42조 (개구부 등의 방호 조치)",url:"https://www.law.go.kr/LSW/lsInfoP.do?lsiSeq=234640#0000"}]:s.includes("화학")||s.includes("chemical")?[{title:"산업안전보건법 제110조 (물질안전보건자료의 작성\xb7제출)",url:"https://www.law.go.kr/LSW/lsInfoP.do?lsiSeq=234639#0000"},{title:"화학물질관리법 제14조 (화학물질 취급기준)",url:"https://www.law.go.kr/LSW/lsInfoP.do?lsiSeq=227622#0000"}]:[{title:"산업안전보건법 제5조 (사업주의 의무)",url:"https://www.law.go.kr/LSW/lsInfoP.do?lsiSeq=234639#0000"},{title:"산업안전보건기준에 관한 규칙 제3조 (안전조치)",url:"https://www.law.go.kr/LSW/lsInfoP.do?lsiSeq=234640#0000"}]}(t),imageMeta:{type:"placeholder"}}}(s)),m("dummy")},300),N.current=setTimeout(async()=>{m("generating");try{let e=await fetch("".concat(j,"/api/ops/generate"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),t=await e.json();if(t.success&&t.data){let e=function(e){try{let s=h.parse(e);return{success:!0,data:s}}catch(e){if(e instanceof o.GaX){let s=e.issues[0];return{success:!1,error:"".concat(s.path.join("."),": ").concat(s.message)}}return{success:!1,error:"Unknown validation error"}}}(t.data);e.success?(u(e.data),m("ready"),g(null)):(console.error("OPS validation failed:",e.error),m("dummy"),g("Data validation warning: "+e.error))}else g(t.error||"Failed to generate preview"),m("dummy")}catch(e){console.error("Preview generation error:",e),g("Network error: Using offline preview"),m("dummy")}},1e3),()=>{N.current&&clearTimeout(N.current),w.current&&clearTimeout(w.current)}},[s]);let Z=(e,s)=>{t(t=>({...t,[e]:s}))},ee=async()=>{if(!x)return void T("Please wait for preview to generate");if(!s.title||!s.title.trim())return void T("Please enter a title for this OPS document");if(!s.incidentDate||!s.location||!s.incidentType||!s.incidentCause)return void T("Please fill all required fields");S(!0),T(null);try{let e=await d("".concat(j,"/api/ops/save"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({title:s.title,incidentDate:s.incidentDate,location:s.location,agentObject:s.agentObject||"",hazardObject:s.hazardObject||"",incidentType:s.incidentType,incidentCause:s.incidentCause,opsDocument:x})});if(401===e.status){T("Unauthorized: Please enter your access key"),K(!0);return}let t=await e.json();t.success&&t.data?(D(t.data.publicUrl),P(t.data.opsId)):T(t.error||"Failed to publish OPS document")}catch(e){T("Network error: Unable to publish OPS document")}finally{S(!1)}},es=()=>{if(H.trim()){var e;e=H.trim(),localStorage.setItem(n,e),V(!0),K(!1),$("")}},et=async()=>{X(!0);try{let e=await d("".concat(j,"/api/subscribers"),{method:"GET"});if(401===e.status){M("인증 오류: 액세스 키를 확인해주세요"),K(!0);return}let s=await e.json();s.success&&s.data&&s.data.subscribers?R(s.data.subscribers):M("구독자 목록을 불러올 수 없습니다")}catch(e){M("네트워크 오류: 구독자 목록을 불러올 수 없습니다")}finally{X(!1)}},ea=async()=>{if(!k||!C)return void M("발행된 OPS 문서가 없습니다");let e=z.split(/[,\n]/).map(e=>e.trim()).filter(e=>e.length>0),s=Array.from(new Set([...Array.from(W),...e]));if(0===s.length)return void M("이메일 주소를 입력하거나 구독자를 선택해주세요");let t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,a=s.filter(e=>!t.test(e));if(a.length>0)return void M("잘못된 이메일 주소: ".concat(a.join(", ")));_(!0),M(null),L(null);try{let e="".concat(window.location.origin).concat(k),t=await d("".concat(j,"/api/send"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({opsId:C,publicUrl:e,recipients:s})});if(401===t.status){M("인증 오류: 액세스 키를 확인해주세요"),K(!0);return}let a=await t.json();a.success&&a.data?(L({sent:a.data.sent,failed:a.data.failed}),Y("")):M(a.error||"이메일 발송 실패")}catch(e){M("네트워크 오류: 이메일을 발송할 수 없습니다")}finally{_(!1)}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(i(),{children:(0,a.jsx)("title",{children:"OPS 작성 도구 | 안전 OPS 뉴스레터"})}),(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,a.jsx)("header",{className:"bg-white border-b border-gray-200",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"OPS 작성 도구"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"재해 정보를 입력하여 OPS 자료를 자동 생성합니다"})]}),(0,a.jsx)("button",{onClick:()=>K(!0),className:"px-4 py-2 text-sm border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:Q?"\uD83D\uDD11 키 변경":"\uD83D\uDD11 액세스 키 입력"})]})})}),(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h2",{className:"text-3xl md:text-4xl font-bold text-gray-900 mb-4",children:"중대재해 개요를 손쉽게 OPS 요약자료로 편집하세요"}),(0,a.jsx)("p",{className:"text-lg md:text-xl text-gray-600",children:"중대재해 개요를 입력하시면 10분만에 관련 법령 / 근본 원인 / 재발방지 체크리스트를 작성해 드립니다"})]}),(0,a.jsxs)("div",{className:"grid md:grid-cols-3 gap-6 max-w-5xl mx-auto",children:[(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow",children:[(0,a.jsx)("div",{className:"text-4xl mb-4",children:"⚡"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"빠른 자동 작성"}),(0,a.jsx)("p",{className:"text-gray-600",children:"10분 이내에 종합적인 OPS 자료를 생성합니다"})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow",children:[(0,a.jsx)("div",{className:"text-4xl mb-4",children:"⚖️"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"관련 법령 조회"}),(0,a.jsx)("p",{className:"text-gray-600",children:"산업안전보건법 등 관련 법령을 자동으로 매칭합니다"})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md hover:shadow-lg transition-shadow",children:[(0,a.jsx)("div",{className:"text-4xl mb-4",children:"✅"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"재발방지 체크리스트"}),(0,a.jsx)("p",{className:"text-gray-600",children:"유사 재해 예방을 위한 실행 가능한 체크리스트를 제공합니다"})]})]})]})}),(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-sm p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"재해 정보 입력"}),(0,a.jsxs)("form",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"title",className:"block text-sm font-medium text-gray-700 mb-1",children:["OPS 제목 ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"text",id:"title",value:s.title||"",onChange:e=>Z("title",e.target.value),placeholder:"예: 비계 추락사고 - 2025년 1월",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"incidentDate",className:"block text-sm font-medium text-gray-700 mb-1",children:["재해 발생 일시 ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"datetime-local",id:"incidentDate",value:s.incidentDate||"",onChange:e=>Z("incidentDate",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 mb-1",children:["재해 발생 장소 ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"text",id:"location",value:s.location||"",onChange:e=>Z("location",e.target.value),placeholder:"예: 서울 건설현장 A동",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"agentObject",className:"block text-sm font-medium text-gray-700 mb-1",children:["재해자 ",(0,a.jsx)("span",{className:"text-gray-400",children:"(선택)"})]}),(0,a.jsx)("input",{type:"text",id:"agentObject",value:s.agentObject||"",onChange:e=>Z("agentObject",e.target.value),placeholder:"예: 작업자, 기계 조작자",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"hazardObject",className:"block text-sm font-medium text-gray-700 mb-1",children:["기인물 ",(0,a.jsx)("span",{className:"text-gray-400",children:"(선택)"})]}),(0,a.jsx)("input",{type:"text",id:"hazardObject",value:s.hazardObject||"",onChange:e=>Z("hazardObject",e.target.value),placeholder:"예: 비계, 화학물질 용기",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"incidentType",className:"block text-sm font-medium text-gray-700 mb-1",children:["재해 발생 형태 ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsxs)("select",{id:"incidentType",value:s.incidentType||"",onChange:e=>Z("incidentType",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0,children:[(0,a.jsx)("option",{value:"",children:"재해 유형 선택"}),(0,a.jsx)("option",{value:"Fall",children:"추락"}),(0,a.jsx)("option",{value:"Chemical Spill",children:"화학물질 누출"}),(0,a.jsx)("option",{value:"Fire",children:"화재"}),(0,a.jsx)("option",{value:"Explosion",children:"폭발"}),(0,a.jsx)("option",{value:"Equipment Failure",children:"장비 고장"}),(0,a.jsx)("option",{value:"Other",children:"기타"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"incidentCause",className:"block text-sm font-medium text-gray-700 mb-1",children:["재해 발생 원인 ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("textarea",{id:"incidentCause",value:s.incidentCause||"",onChange:e=>Z("incidentCause",e.target.value),placeholder:"재해의 주요 원인을 상세히 기술해 주세요...",rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),b&&(0,a.jsxs)("div",{className:"text-sm text-amber-600 bg-amber-50 p-3 rounded-md border border-amber-200",children:["⚠️ ",b]}),(0,a.jsxs)("div",{className:"pt-4 border-t border-gray-200",children:[(0,a.jsx)("button",{type:"button",onClick:ee,disabled:v||!x||!(null==(e=s.title)?void 0:e.trim()),className:"w-full px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed font-medium transition-colors",children:v?"\uD83D\uDCE4 발행 중...":"\uD83D\uDCE4 OPS 문서 발행"}),O&&(0,a.jsxs)("p",{className:"text-red-600 text-sm mt-2",children:["⚠️ ",O]})]})]})]}),(0,a.jsx)(p,{state:r,data:x,error:b,activeTab:y,onTabChange:f})]})}),G&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-8 max-w-md w-full mx-4",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"\uD83D\uDD11 액세스 키 필요"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"OPS 문서를 생성하고 발행하려면 관리자 액세스 키가 필요합니다."}),(0,a.jsx)("input",{type:"password",value:H,onChange:e=>$(e.target.value),onKeyDown:e=>"Enter"===e.key&&es(),placeholder:"액세스 키를 입력하세요",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 mb-4",autoFocus:!0}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:es,disabled:!H.trim(),className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors font-medium",children:"저장"}),(0,a.jsx)("button",{onClick:()=>{K(!1),$("")},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"취소"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-4",children:"\uD83D\uDCA1 액세스 키는 브라우저에 로컬 저장되며, 인증 목적으로만 서버에 전송됩니다."})]})}),k&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-8 max-w-md w-full mx-4",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"✅ OPS 문서 발행 완료!"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"OPS 문서가 성공적으로 발행되었습니다. 아래 공개 URL로 접근할 수 있습니다."}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg mb-6",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-2",children:"공개 URL:"}),(0,a.jsxs)("p",{className:"text-blue-600 break-all",children:[window.location.origin,k]})]}),(0,a.jsxs)("div",{className:"flex gap-3 mb-3",children:[(0,a.jsx)("button",{onClick:()=>{if(k){let e="".concat(window.location.origin).concat(k);navigator.clipboard.writeText(e)}},className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"\uD83D\uDCCB 링크 복사"}),(0,a.jsx)("a",{href:k,target:"_blank",rel:"noopener noreferrer",className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium text-center",children:"\uD83D\uDC41️ 페이지 보기"})]}),Q&&(0,a.jsx)("button",{onClick:()=>q(!0),className:"w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium mb-3",children:"\uD83D\uDCE7 이메일로 공유 (관리자 전용)"}),(0,a.jsx)("button",{onClick:()=>{D(null),P(null)},className:"w-full px-4 py-2 text-gray-600 hover:text-gray-800 text-sm",children:"닫기"})]})}),I&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-8 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"\uD83D\uDCE7 이메일로 OPS 공유"}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900",children:"뉴스레터 구독자"}),(0,a.jsx)("button",{onClick:et,disabled:J,className:"text-sm px-3 py-1 bg-blue-100 text-blue-700 rounded hover:bg-blue-200 disabled:bg-gray-100 disabled:text-gray-400 transition-colors",children:J?"⏳ 로딩 중...":"\uD83D\uDD04 구독자 불러오기"})]}),U.length>0&&(0,a.jsxs)("div",{className:"border border-gray-200 rounded-lg p-4 max-h-60 overflow-y-auto bg-gray-50",children:[(0,a.jsx)("div",{className:"mb-3",children:(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-100 p-2 rounded",children:[(0,a.jsx)("input",{type:"checkbox",checked:W.size===U.length&&U.length>0,onChange:()=>{W.size===U.length?B(new Set):B(new Set(U.map(e=>e.email)))},className:"w-4 h-4"}),(0,a.jsxs)("span",{className:"font-medium text-gray-700",children:["전체 선택 (",U.length,"명)"]})]})}),(0,a.jsx)("div",{className:"space-y-1",children:U.map(e=>(0,a.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer hover:bg-gray-100 p-2 rounded",children:[(0,a.jsx)("input",{type:"checkbox",checked:W.has(e.email),onChange:()=>(e=>{let s=new Set(W);s.has(e)?s.delete(e):s.add(e),B(s)})(e.email),className:"w-4 h-4"}),(0,a.jsx)("span",{className:"text-sm text-gray-700",children:e.email})]},e.id))})]}),0===U.length&&!J&&(0,a.jsx)("p",{className:"text-sm text-gray-500 italic",children:"구독자 목록을 불러오려면 위 버튼을 클릭하세요"})]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900 mb-2",children:"추가 이메일 주소 (선택)"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-2",children:"여러 주소는 쉼표(,) 또는 줄바꿈으로 구분합니다."}),(0,a.jsx)("textarea",{value:z,onChange:e=>Y(e.target.value),placeholder:"예: hong@example.com, kim@example.com lee@example.com",rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500"})]}),(W.size>0||z.trim())&&(0,a.jsx)("div",{className:"mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:(0,a.jsxs)("p",{className:"text-sm text-blue-800",children:["\uD83D\uDCEE 총 ",(0,a.jsx)("strong",{children:W.size+z.split(/[,\n]/).filter(e=>e.trim()).length}),"명에게 발송됩니다"]})}),A&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4",children:(0,a.jsxs)("p",{className:"text-red-600 text-sm",children:["⚠️ ",A]})}),F&&(0,a.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 mb-4",children:(0,a.jsxs)("p",{className:"text-green-700 text-sm font-medium",children:["✅ 발송 완료: ",F.sent,"건",F.failed>0&&" / 실패: ".concat(F.failed,"건")]})}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:ea,disabled:E||0===W.size&&!z.trim(),className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors font-medium",children:E?"\uD83D\uDCE4 발송 중...":"\uD83D\uDCE4 이메일 발송"}),(0,a.jsx)("button",{onClick:()=>{q(!1),Y(""),M(null),L(null),B(new Set),R([])},className:"flex-1 px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"취소"})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-4",children:"\uD83D\uDCA1 이메일에는 OPS 문서 링크와 요약 정보가 포함됩니다."})]})})]})]})}},6028:(e,s,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/builder",function(){return t(1859)}])}},e=>{e.O(0,[149,636,593,792],()=>e(e.s=6028)),_N_E=e.O()}]);